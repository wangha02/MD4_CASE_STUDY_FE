<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Title</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.6.1/jquery.min.js"
            integrity="sha512-aVKKRRi/Q/YV+4mjoKBsE4x3H+BkegoM/em46NNlCqNTmUYADjBbeNefNxYV7giUp0VxICtqdrbqU7iVaeZNXA=="
            crossorigin="anonymous" referrerpolicy="no-referrer"></script>

</head>
<body>
<table border="1">
    <p id="delete"></p>
    <tr>
        <td>Name</td>
        <td><input type="text" id="nameComic"></td>
    </tr>
    <tr>
        <td>Comic</td>
        <td><input type="text" id="linkComic"></td>
    </tr>
<!--    <tr>-->
<!--        <td>Category</td>-->
<!--        <td><input type="text" id="nameCategory"></td>-->
<!--    </tr>-->
    <tr>
        <td>
            <button onclick="deleteComic()">Delete</button>
        </td>
        <td><a href="listComic.html">Back list</a></td>

    </tr>
    <script>
        let query = window.location.search;
        let id = new URLSearchParams(query).get("id");
        console.log(id)
        $(document).ready(function (){
            getComic()
        })
        function getComic(){
            $.ajax({
                url:'http://localhost:8080/api/comic/'+id,
                method:'GET',
                contentType:'application/Json; charset=UTF-8',
                headers:{
                    Authorization:"Bearer" + window.localStorage.getItem('TOKEN_KEY')
                },
                success: function (data){
                    $('#nameComic').val(data.name);
                    $('#linkComic').val(data.comic);
                    return;
                },
                error: function (){
                    document.getElementById('delete').innerHTML = "comic does not exist!!";
                }
            })
        }

        function deleteComic(){
            let film = {
                name : $('#name'),
                comic : $('#comic')
            }
            $.ajax({
                url:'http://localhost:8080/api/comic/'+id,
                method:'DELETE',
                data: JSON.stringify(film),
                contentType:'application/Json; charset=UTF-8',
                success:function film(){
                    document.getElementById('delete').innerHTML = "delete_success!"
                    return;
                },error: function (){
                    document.getElementById('delete').innerHTML = "delete_failed"
                }
            })
        }

    </script>
</table>
</body>
</html>